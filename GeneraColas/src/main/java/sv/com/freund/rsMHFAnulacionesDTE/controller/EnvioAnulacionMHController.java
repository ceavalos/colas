package sv.com.freund.rsMHFAnulacionesDTE.controller;

import javax.naming.InitialContext;
import org.apache.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import springfox.documentation.annotations.ApiIgnore;
import sv.com.freund.rsMHFAnulacionesDTE.service.EnvioDTEService;
import sv.com.freund.rsMHFAnulacionesDTE.service.ListenerProcessContainer;
import sv.com.freund.rsMHFAnulacionesDTE.service.ProcessThread;
import sv.com.freund.rsMHFAnulacionesDTE.service.ReadFromQueue;

@RequestMapping(value = "/envioAnulacionesMH")
@RestController
public class EnvioAnulacionMHController {

    @Autowired
    private EnvioDTEService service;
    
    @Autowired
    private ListenerProcessContainer listenerProcessContainer;

    static Logger log = Logger.getLogger(EnvioAnulacionMHController.class);

    /**
     * Metodo para procesar el json DTE del MH
     *
     * @param codgeneracion codigo Ãºnico de identificacion del documento electronico
     * @param codtd codigo del tipo de documento
     * @param json { "version":2, "idEnvio":1, "ambiente":"01",
     * "documento":"eyJhbGciOiJSUzUxMiJ9.ewogICJpZGVudGlmaWNhY2lvbiIgOiB7CiAgICAidmVyc2lvbiIgOiAzLAogICAgImFtYmllbnRlIiA6ICIwMSIsCiAgICAidGlwb0R0ZSIgOiAiMDMiLAogICAgIm51bWVyb0NvbnRyb2wiIDogIkRURS0wMy0wMDAwMDAwMC0wMDAwMDAwMDAwMTg3NjQiLAogICAgImNvZGlnb0dlbmVyYWNpb24iIDogIjY3RDkwQjM4LThBOTMtNDUyQi05QzY3LUExNTYyNzhFMjFCMyIsCiAgICAidGlwb01vZGVsbyIgOiAxLAogICAgInRpcG9PcGVyYWNpb24iIDogMSwKICAgICJmZWNFbWkiIDogIjIwMjItMDUtMTkiLAogICAgImhvckVtaSIgOiAiMTY6MDE6MzMiLAogICAgInRpcG9Nb25lZGEiIDogIlVTRCIKICB9LAogICJlbWlzb3IiIDogewogICAgIm5pdCIgOiAiMDYxNDE3MDQ2NzAwMjIiLAogICAgIm5yYyIgOiAiMzA1MCIsCiAgICAibm9tYnJlIiA6ICJQUk9EVUNUSVZFIEJVU0lORVNTIFNPTFVUSU9OUyBFTCBTQUxWQURPUiwgU0EgREUgQ1YiLAogICAgImNvZEFjdGl2aWRhZCIgOiAiNDY1MTAiLAogICAgImRlc2NBY3RpdmlkYWQiIDogIlZlbnRhIGFsIHBvciBtYXlvciBkZSBjb21wdXRhZG9yYXMsIGVxdWlwbyBwZXJpZmVyaWNvIHkgcHJvZ3JhbWFzIGluZm9ybWF0aWNvcyIsCiAgICAibm9tYnJlQ29tZXJjaWFsIiA6ICJQQlMgRUwgU0FMVkFET1IsIFNBIERFIENWIiwKICAgICJ0aXBvRXN0YWJsZWNpbWllbnRvIiA6ICIwMiIsCiAgICAiZGlyZWNjaW9uIiA6IHsKICAgICAgImRlcGFydGFtZW50byIgOiAiMDUiLAogICAgICAibXVuaWNpcGlvIiA6ICIwMSIsCiAgICAgICJjb21wbGVtZW50byIgOiAiRmluYWwgQm91bGV2YXJkIFNhbnRhIEVsZW5hIHkgQm91bGV2YXJkIE9yZGVuIGRlIE1hbHRhLCBFZGlmaWNpbyBYZXJveCIKICAgIH0sCiAgICAidGVsZWZvbm8iIDogIjIyMzkzMDAwIiwKICAgICJjb3JyZW8iIDogImVybmVzdG8uZ3VldmFyYUBncm91cHBicy5jb20iCiAgfSwKICAicmVjZXB0b3IiIDogewogICAgIm5pdCIgOiAiMDYxNDAxMDg1ODAwMTciLAogICAgIm5yYyIgOiAiNDE4IiwKICAgICJub21icmUiIDogIkZSRVVORCBERSBFTCBTQUxWQURPUiwgUy5BLiBERSBDLlYuIiwKICAgICJjb2RBY3RpdmlkYWQiIDogIjQ2NjMyIiwKICAgICJkZXNjQWN0aXZpZGFkIiA6ICJWRU5UQSBBTCBQT1IgTUFZT1IgREUgQVJUw41DVUxPUyBERSBGRVJSRVRFUsONQSBZIFBJTlRVUkVSw41BU1xuXHIiLAogICAgIm5vbWJyZUNvbWVyY2lhbCIgOiAiRlJFVU5EIERFIEVMIFNBTFZBRE9SLCBTLkEuIERFIEMuVi4iLAogICAgImRpcmVjY2lvbiIgOiB7CiAgICAgICJkZXBhcnRhbWVudG8iIDogIjA2IiwKICAgICAgIm11bmljaXBpbyIgOiAiMTQiLAogICAgICAiY29tcGxlbWVudG8iIDogIlBST0xPTkdBQ0lPTiBBVVRPUElTVEEgTk9SVEUgQ09MLiBNT01QRUdPTiwgQ0FMTEUgUFBBTCBZIFBKRSBGUkVVTkQgIyAzLFNBTiBTQUxWQURPUiIKICAgIH0sCiAgICAidGVsZWZvbm8iIDogIjI1MDA4NDU5IiwKICAgICJjb3JyZW8iIDogIm1hcmlvc0BmcmV1bmRzYS5jb20iCiAgfSwKICAiY3VlcnBvRG9jdW1lbnRvIiA6IFsgewogICAgIm51bUl0ZW0iIDogMSwKICAgICJ0aXBvSXRlbSIgOiAxLAogICAgImNhbnRpZGFkIiA6IDEuMCwKICAgICJjb2RpZ28iIDogIk9UUk9TIiwKICAgICJ1bmlNZWRpZGEiIDogNTksCiAgICAiZGVzY3JpcGNpb24iIDogIlJFTk9WQUNJT04gREUgT1JBQ0xFIENMT1VEIFNFUlZJQ0VTfHx8fHx8fHx8fHx8UkVOT1ZBQ0lPTiBERSBPUkFDTEUgQ0xPVUQgU0VSVklDRVN8IiwKICAgICJwcmVjaW9VbmkiIDogMTAwLjAsCiAgICAibW9udG9EZXNjdSIgOiAwLjAsCiAgICAidmVudGFOb1N1aiIgOiAwLjAsCiAgICAidmVudGFFeGVudGEiIDogMC4wLAogICAgInZlbnRhR3JhdmFkYSIgOiAxMDAuMCwKICAgICJub0dyYXZhZG8iIDogMC4wLAogICAgInRyaWJ1dG9zIiA6IFsgIjIwIiBdLAogICAgInBzdiIgOiAwLjAKICB9IF0sCiAgInJlc3VtZW4iIDogewogICAgInRvdGFsTm9TdWoiIDogMC4wLAogICAgInRvdGFsRXhlbnRhIiA6IDAuMCwKICAgICJ0b3RhbEdyYXZhZGEiIDogMTAwLjAsCiAgICAic3ViVG90YWxWZW50YXMiIDogMTAwLjAsCiAgICAiZGVzY3VOb1N1aiIgOiAwLjAsCiAgICAiZGVzY3VFeGVudGEiIDogMC4wLAogICAgImRlc2N1R3JhdmFkYSIgOiAwLjAsCiAgICAicG9yY2VudGFqZURlc2N1ZW50byIgOiAwLjAsCiAgICAidG90YWxEZXNjdSIgOiAwLjAsCiAgICAidHJpYnV0b3MiIDogWyB7CiAgICAgICJjb2RpZ28iIDogIjIwIiwKICAgICAgImRlc2NyaXBjaW9uIiA6ICJJbXB1ZXN0byAgYWwgVmFsb3IgQWdyZWdhZG8gMTMlIiwKICAgICAgInZhbG9yIiA6IDEzCiAgICB9IF0sCiAgICAic3ViVG90YWwiIDogMTAwLjAsCiAgICAiaXZhUGVyY2kxIiA6IDAuMCwKICAgICJpdmFSZXRlMSIgOiAwLjAsCiAgICAicmV0ZVJlbnRhIiA6IDAuMCwKICAgICJtb250b1RvdGFsT3BlcmFjaW9uIiA6IDExMy4wLAogICAgInRvdGFsTm9HcmF2YWRvIiA6IDAuMCwKICAgICJ0b3RhbFBhZ2FyIiA6IDExMy4wLAogICAgInRvdGFsTGV0cmFzIiA6ICJDaWVudG8gdHJlY2UgRMOzbGFyZXMgVVMgY29uIDAwLzEwMCIsCiAgICAic2FsZG9GYXZvciIgOiAwLjAsCiAgICAiY29uZGljaW9uT3BlcmFjaW9uIiA6IDIsCiAgICAicGFnb3MiIDogWyB7CiAgICAgICJjb2RpZ28iIDogIjk5IiwKICAgICAgIm1vbnRvUGFnbyIgOiAxMTMuMCwKICAgICAgInBsYXpvIiA6ICIwMiIsCiAgICAgICJwZXJpb2RvIiA6IDEKICAgIH0gXQogIH0sCiAgImV4dGVuc2lvbiIgOiB7CiAgICAibm9tYkVudHJlZ2EiIDogIk1hdXJvIEZyYW5jaXNjbyBNZWrDrWEgTMOzcGV6IiwKICAgICJkb2N1RW50cmVnYSIgOiAiMDE1MDU1NDYwIiwKICAgICJub21iUmVjaWJlIiA6ICJFRFVBUkRPIERBVklEIEZSRVVORCBXQUlERVJHT1IiLAogICAgImRvY3VSZWNpYmUiIDogIjAwNDg5MDA4LTMiLAogICAgIm9ic2VydmFjaW9uZXMiIDogIlNpbiBPYnNlcnZhY2lvbmVzIgogIH0sCiAgImFwZW5kaWNlIiA6IFsgewogICAgImNhbXBvIiA6ICJhcGVuZGljZXMwMSIsCiAgICAiZXRpcXVldGEiIDogImFwZW5kaWNlczAxIiwKICAgICJ2YWxvciIgOiAifFNBTC1GTy1GRTEtQ0YtMTczNnwxfDF8IgogIH0sIHsKICAgICJjYW1wbyIgOiAiYXBlbmRpY2VzMDIiLAogICAgImV0aXF1ZXRhIiA6ICJhcGVuZGljZXMwMiIsCiAgICAidmFsb3IiIDogImNlbnRyYWwtcGJzfEZPfDAwMTI1OTJ8MTN8IgogIH0sIHsKICAgICJjYW1wbyIgOiAiYXBlbmRpY2VzMDMiLAogICAgImV0aXF1ZXRhIiA6ICJhcGVuZGljZXMwMyIsCiAgICAidmFsb3IiIDogInx8fHwiCiAgfSwgewogICAgImNhbXBvIiA6ICJhcGVuZGljZXMwNCIsCiAgICAiZXRpcXVldGEiIDogImFwZW5kaWNlczA0IiwKICAgICJ2YWxvciIgOiAiICIKICB9LCB7CiAgICAiY2FtcG8iIDogImxpc3RhRW1haWxzIiwKICAgICJldGlxdWV0YSIgOiAibGlzdGFFbWFpbHMiLAogICAgInZhbG9yIiA6ICJtYXJpb3NAZnJldW5kc2EuY29tIgogIH0sIHsKICAgICJjYW1wbyIgOiAiZGlyZW50cmVnYSIsCiAgICAiZXRpcXVldGEiIDogImRpcmVudHJlZ2EiLAogICAgInZhbG9yIiA6ICIgIgogIH0gXSwKICAicmVzcG9uc2VNSCIgOiB7CiAgICAidmVyc2lvbiIgOiAyLAogICAgImFtYmllbnRlIiA6ICIwMSIsCiAgICAidmVyc2lvbkFwcCIgOiAyLAogICAgImVzdGFkbyIgOiAiUFJPQ0VTQURPIiwKICAgICJjb2RpZ29HZW5lcmFjaW9uIiA6ICI2N0Q5MEIzOC04QTkzLTQ1MkItOUM2Ny1BMTU2Mjc4RTIxQjMiLAogICAgIm51bWVyb0NvbnRyb2wiIDogIkRURS0wMy0wMDAwMDAwMC0wMDAwMDAwMDAwMTg3NjQiLAogICAgInNlbGxvUmVjaWJpZG8iIDogIjIwMjJFODg0MjJENzU4REE0QkE3OTNCOTgzMzc5QTczQTJBOFlaMUUiLAogICAgImZoUHJvY2VzYW1pZW50byIgOiAiMTkvMDUvMjAyMiAxNjowMTozNCIsCiAgICAiY29kaWdvTXNnIiA6ICIwMDEiLAogICAgImRlc2NyaXBjaW9uTXNnIiA6ICJSRUNJQklETyIsCiAgICAib2JzZXJ2YWNpb25lcyIgOiBbIF0KICB9LAogICJjb2RpZ29FbXByZXNhIiA6ICJQQlMiLAogICJ0b2tlbiIgOiAiZXlKaGJHY2lPaUpTVXpVeE1pSjkuZXdvZ0lDSnBaR1Z1ZEdsbWFXTmhZMmx2YmlJNklIc0tJQ0FnSUNKMlpYSnphVzl1SWpvZ015d0tJQ0FnSUNKaGJXSnBaVzUwWlNJNklDSXdNU0lzQ2lBZ0lDQWlkR2x3YjBSMFpTSTZJQ0l3TXlJc0NpQWdJQ0FpYm5WdFpYSnZRMjl1ZEhKdmJDSTZJQ0pFVkVVdE1ETXRNREF3TURBd01EQXRNREF3TURBd01EQXdNREU0TnpZMElpd0tJQ0FnSUNKamIyUnBaMjlIWlc1bGNtRmphVzl1SWpvZ0lqWTNSRGt3UWpNNExUaEJPVE10TkRVeVFpMDVRelkzTFVFeE5UWXlOemhGTWpGQ015SXNDaUFnSUNBaWRHbHdiMDF2WkdWc2J5STZJREVzQ2lBZ0lDQWlkR2x3YjA5d1pYSmhZMmx2YmlJNklERXNDaUFnSUNBaWRHbHdiME52Ym5ScGJtZGxibU5wWVNJNklHNTFiR3dzQ2lBZ0lDQWliVzkwYVhadlEyOXVkR2x1SWpvZ2JuVnNiQ3dLSUNBZ0lDSm1aV05GYldraU9pQWlNakF5TWkwd05TMHhPU0lzQ2lBZ0lDQWlhRzl5UlcxcElqb2dJakUyT2pBeE9qTXpJaXdLSUNBZ0lDSjBhWEJ2VFc5dVpXUmhJam9nSWxWVFJDSUtJQ0I5TEFvZ0lDSmtiMk4xYldWdWRHOVNaV3hoWTJsdmJtRmtieUk2SUc1MWJHd3NDaUFnSW1WdGFYTnZjaUk2SUhzS0lDQWdJQ0p1YVhRaU9pQWlNRFl4TkRFM01EUTJOekF3TWpJaUxBb2dJQ0FnSW01eVl5STZJQ0l6TURVd0lpd0tJQ0FnSUNKdWIyMWljbVVpT2lBaVVGSlBSRlZEVkVsV1JTQkNWVk5KVGtWVFV5QlRUMHhWVkVsUFRsTWdSVXdnVTBGTVZrRkVUMUlzSUZOQklFUkZJRU5XSWl3S0lDQWdJQ0pqYjJSQlkzUnBkbWxrWVdRaU9pQWlORFkxTVRBaUxBb2dJQ0FnSW1SbGMyTkJZM1JwZG1sa1lXUWlPaUFpVm1WdWRHRWdZV3dnY0c5eUlHMWhlVzl5SUdSbElHTnZiWEIxZEdGa2IzSmhjeXdnWlhGMWFYQnZJSEJsY21sbVpYSnBZMjhnZVNCd2NtOW5jbUZ0WVhNZ2FXNW1iM0p0WVhScFkyOXpJaXdLSUNBZ0lDSnViMjFpY21WRGIyMWxjbU5wWVd3aU9pQWlVRUpUSUVWTUlGTkJURlpCUkU5U0xDQlRRU0JFUlNCRFZpSXNDaUFnSUNBaWRHbHdiMFZ6ZEdGaWJHVmphVzFwWlc1MGJ5STZJQ0l3TWlJc0NpQWdJQ0FpWkdseVpXTmphVzl1SWpvZ2V3b2dJQ0FnSUNBaVpHVndZWEowWVcxbGJuUnZJam9nSWpBMUlpd0tJQ0FnSUNBZ0ltMTFibWxqYVhCcGJ5STZJQ0l3TVNJc0NpQWdJQ0FnSUNKamIyMXdiR1Z0Wlc1MGJ5STZJQ0pHYVc1aGJDQkNiM1ZzWlhaaGNtUWdVMkZ1ZEdFZ1JXeGxibUVnZVNCQ2IzVnNaWFpoY21RZ1QzSmtaVzRnWkdVZ1RXRnNkR0VzSUVWa2FXWnBZMmx2SUZobGNtOTRJZ29nSUNBZ2ZTd0tJQ0FnSUNKMFpXeGxabTl1YnlJNklDSXlNak01TXpBd01DSXNDaUFnSUNBaVkyOXljbVZ2SWpvZ0ltVnlibVZ6ZEc4dVozVmxkbUZ5WVVCbmNtOTFjSEJpY3k1amIyMGlMQW9nSUNBZ0ltTnZaRVZ6ZEdGaWJHVk5TQ0k2SUc1MWJHd3NDaUFnSUNBaVkyOWtSWE4wWVdKc1pTSTZJRzUxYkd3c0NpQWdJQ0FpWTI5a1VIVnVkRzlXWlc1MFlVMUlJam9nYm5Wc2JDd0tJQ0FnSUNKamIyUlFkVzUwYjFabGJuUmhJam9nYm5Wc2JBb2dJSDBzQ2lBZ0luSmxZMlZ3ZEc5eUlqb2dld29nSUNBZ0ltNXBkQ0k2SUNJd05qRTBNREV3T0RVNE1EQXhOeUlzQ2lBZ0lDQWlibkpqSWpvZ0lqUXhPQ0lzQ2lBZ0lDQWlibTl0WW5KbElqb2dJa1pTUlZWT1JDQkVSU0JGVENCVFFVeFdRVVJQVWl3Z1V5NUJMaUJFUlNCRExsWXVJaXdLSUNBZ0lDSmpiMlJCWTNScGRtbGtZV1FpT2lBaU5EWTJNeklpTEFvZ0lDQWdJbVJsYzJOQlkzUnBkbWxrWVdRaU9pQWlWa1ZPVkVFZ1FVd2dVRTlTSUUxQldVOVNJRVJGSUVGU1ZNT05RMVZNVDFNZ1JFVWdSa1ZTVWtWVVJWTERqVUVnV1NCUVNVNVVWVkpGVXNPTlFWTmNibHh5SWl3S0lDQWdJQ0p1YjIxaWNtVkRiMjFsY21OcFlXd2lPaUFpUmxKRlZVNUVJRVJGSUVWTUlGTkJURlpCUkU5U0xDQlRMa0V1SUVSRklFTXVWaTRpTEFvZ0lDQWdJbVJwY21WalkybHZiaUk2SUhzS0lDQWdJQ0FnSW1SbGNHRnlkR0Z0Wlc1MGJ5STZJQ0l3TmlJc0NpQWdJQ0FnSUNKdGRXNXBZMmx3YVc4aU9pQWlNVFFpTEFvZ0lDQWdJQ0FpWTI5dGNHeGxiV1Z1ZEc4aU9pQWlVRkpQVEU5T1IwRkRTVTlPSUVGVlZFOVFTVk5VUVNCT1QxSlVSU0JEVDB3dUlFMVBUVkJGUjA5T0xDQkRRVXhNUlNCUVVFRk1JRmtnVUVwRklFWlNSVlZPUkNBaklETXNVMEZPSUZOQlRGWkJSRTlTSWdvZ0lDQWdmU3dLSUNBZ0lDSjBaV3hsWm05dWJ5STZJQ0l5TlRBd09EUTFPU0lzQ2lBZ0lDQWlZMjl5Y21Wdklqb2dJbTFoY21sdmMwQm1jbVYxYm1SellTNWpiMjBpQ2lBZ2ZTd0tJQ0FpYjNSeWIzTkViMk4xYldWdWRHOXpJam9nYm5Wc2JDd0tJQ0FpZG1WdWRHRlVaWEpqWlhKdklqb2diblZzYkN3S0lDQWlZM1ZsY25CdlJHOWpkVzFsYm5Sdklqb2dXd29nSUNBZ2V3b2dJQ0FnSUNBaWJuVnRTWFJsYlNJNklERXNDaUFnSUNBZ0lDSjBhWEJ2U1hSbGJTSTZJREVzQ2lBZ0lDQWdJQ0p1ZFcxbGNtOUViMk4xYldWdWRHOGlPaUJ1ZFd4c0xBb2dJQ0FnSUNBaVkyOWthV2R2SWpvZ0lrOVVVazlUSWl3S0lDQWdJQ0FnSW1OdlpGUnlhV0oxZEc4aU9pQnVkV3hzTEFvZ0lDQWdJQ0FpWkdWelkzSnBjR05wYjI0aU9pQWlVa1ZPVDFaQlEwbFBUaUJFUlNCUFVrRkRURVVnUTB4UFZVUWdVMFZTVmtsRFJWTjhmSHg4Zkh4OGZIeDhmSHhTUlU1UFZrRkRTVTlPSUVSRklFOVNRVU5NUlNCRFRFOVZSQ0JUUlZKV1NVTkZVM3dpTEFvZ0lDQWdJQ0FpWTJGdWRHbGtZV1FpT2lBeExqQXNDaUFnSUNBZ0lDSjFibWxOWldScFpHRWlPaUExT1N3S0lDQWdJQ0FnSW5CeVpXTnBiMVZ1YVNJNklERXpNakUxTGpBc0NpQWdJQ0FnSUNKdGIyNTBiMFJsYzJOMUlqb2dNQzR3TEFvZ0lDQWdJQ0FpZG1WdWRHRk9iMU4xYWlJNklEQXVNQ3dLSUNBZ0lDQWdJblpsYm5SaFJYaGxiblJoSWpvZ01DNHdMQW9nSUNBZ0lDQWlkbVZ1ZEdGSGNtRjJZV1JoSWpvZ01UTXlNVFV1TUN3S0lDQWdJQ0FnSW5SeWFXSjFkRzl6SWpvZ1d3b2dJQ0FnSUNBZ0lDSXlNQ0lLSUNBZ0lDQWdYU3dLSUNBZ0lDQWdJbkJ6ZGlJNklEQXVNQ3dLSUNBZ0lDQWdJbTV2UjNKaGRtRmtieUk2SURBdU1Bb2dJQ0FnZlFvZ0lGMHNDaUFnSW5KbGMzVnRaVzRpT2lCN0NpQWdJQ0FpZEc5MFlXeE9iMU4xYWlJNklEQXVNQ3dLSUNBZ0lDSjBiM1JoYkVWNFpXNTBZU0k2SURBdU1Dd0tJQ0FnSUNKMGIzUmhiRWR5WVhaaFpHRWlPaUF4TXpJeE5TNHdMQW9nSUNBZ0luTjFZbFJ2ZEdGc1ZtVnVkR0Z6SWpvZ01UTXlNVFV1TUN3S0lDQWdJQ0prWlhOamRVNXZVM1ZxSWpvZ01DNHdMQW9nSUNBZ0ltUmxjMk4xUlhobGJuUmhJam9nTUM0d0xBb2dJQ0FnSW1SbGMyTjFSM0poZG1Ga1lTSTZJREF1TUN3S0lDQWdJQ0p3YjNKalpXNTBZV3BsUkdWelkzVmxiblJ2SWpvZ01DNHdMQW9nSUNBZ0luUnZkR0ZzUkdWelkzVWlPaUF3TGpBc0NpQWdJQ0FpZEhKcFluVjBiM01pT2lCYkNpQWdJQ0FnSUhzS0lDQWdJQ0FnSUNBaVkyOWthV2R2SWpvZ0lqSXdJaXdLSUNBZ0lDQWdJQ0FpWkdWelkzSnBjR05wYjI0aU9pQWlTVzF3ZFdWemRHOGdJR0ZzSUZaaGJHOXlJRUZuY21WbllXUnZJREV6SlNJc0NpQWdJQ0FnSUNBZ0luWmhiRzl5SWpvZ01UY3hOeTQ1TlFvZ0lDQWdJQ0I5Q2lBZ0lDQmRMQW9nSUNBZ0luTjFZbFJ2ZEdGc0lqb2dNVE15TVRVdU1Dd0tJQ0FnSUNKcGRtRlFaWEpqYVRFaU9pQXdMakFzQ2lBZ0lDQWlhWFpoVW1WMFpURWlPaUF3TGpBc0NpQWdJQ0FpY21WMFpWSmxiblJoSWpvZ01DNHdMQW9nSUNBZ0ltMXZiblJ2Vkc5MFlXeFBjR1Z5WVdOcGIyNGlPaUF4TkRrek1pNDVOU3dLSUNBZ0lDSjBiM1JoYkU1dlIzSmhkbUZrYnlJNklEQXVNQ3dLSUNBZ0lDSjBiM1JoYkZCaFoyRnlJam9nTVRRNU16SXVPVFVzQ2lBZ0lDQWlkRzkwWVd4TVpYUnlZWE1pT2lBaVEyRjBiM0pqWlNCTmFXd2dUbTkyWldOcFpXNTBiM01nVkhKbGFXNTBZU0I1SUVSdmN5QkV3N05zWVhKbGN5QlZVeUJqYjI0Z09UVXZNVEF3SWl3S0lDQWdJQ0p6WVd4a2IwWmhkbTl5SWpvZ01DNHdMQW9nSUNBZ0ltTnZibVJwWTJsdmJrOXdaWEpoWTJsdmJpSTZJRElzQ2lBZ0lDQWljR0ZuYjNNaU9pQmJDaUFnSUNBZ0lIc0tJQ0FnSUNBZ0lDQWlZMjlrYVdkdklqb2dJams1SWl3S0lDQWdJQ0FnSUNBaWJXOXVkRzlRWVdkdklqb2dNVFE1TXpJdU9UVXNDaUFnSUNBZ0lDQWdJbkpsWm1WeVpXNWphV0VpT2lCdWRXeHNMQW9nSUNBZ0lDQWdJQ0p3YkdGNmJ5STZJQ0l3TWlJc0NpQWdJQ0FnSUNBZ0luQmxjbWx2Wkc4aU9pQXhDaUFnSUNBZ0lIMEtJQ0FnSUYwc0NpQWdJQ0FpYm5WdFVHRm5iMFZzWldOMGNtOXVhV052SWpvZ2JuVnNiQW9nSUgwc0NpQWdJbVY0ZEdWdWMybHZiaUk2SUhzS0lDQWdJQ0p1YjIxaVJXNTBjbVZuWVNJNklDSk5ZWFZ5YnlCR2NtRnVZMmx6WTI4Z1RXVnF3NjFoSUV6RHMzQmxlaUlzQ2lBZ0lDQWlaRzlqZFVWdWRISmxaMkVpT2lBaU1ERTFNRFUxTkRZd0lpd0tJQ0FnSUNKdWIyMWlVbVZqYVdKbElqb2dJa1ZFVlVGU1JFOGdSRUZXU1VRZ1JsSkZWVTVFSUZkQlNVUkZVa2RQVWlJc0NpQWdJQ0FpWkc5amRWSmxZMmxpWlNJNklDSXdNRFE0T1RBd09DMHpJaXdLSUNBZ0lDSnZZbk5sY25aaFkybHZibVZ6SWpvZ0lsTnBiaUJQWW5ObGNuWmhZMmx2Ym1Weklpd0tJQ0FnSUNKd2JHRmpZVlpsYUdsamRXeHZJam9nYm5Wc2JBb2dJSDBzQ2lBZ0ltRndaVzVrYVdObElqb2dXd29nSUNBZ2V3b2dJQ0FnSUNBaVkyRnRjRzhpT2lBaVlYQmxibVJwWTJWek1ERWlMQW9nSUNBZ0lDQWlaWFJwY1hWbGRHRWlPaUFpWVhCbGJtUnBZMlZ6TURFaUxBb2dJQ0FnSUNBaWRtRnNiM0lpT2lBaWZGTkJUQzFHVHkxR1JURXRRMFl0TVRjek5ud3hmREY4SWdvZ0lDQWdmU3dLSUNBZ0lIc0tJQ0FnSUNBZ0ltTmhiWEJ2SWpvZ0ltRndaVzVrYVdObGN6QXlJaXdLSUNBZ0lDQWdJbVYwYVhGMVpYUmhJam9nSW1Gd1pXNWthV05sY3pBeUlpd0tJQ0FnSUNBZ0luWmhiRzl5SWpvZ0ltTmxiblJ5WVd3dGNHSnpmRVpQZkRBd01USTFPVEo4TVROOElnb2dJQ0FnZlN3S0lDQWdJSHNLSUNBZ0lDQWdJbU5oYlhCdklqb2dJbUZ3Wlc1a2FXTmxjekF6SWl3S0lDQWdJQ0FnSW1WMGFYRjFaWFJoSWpvZ0ltRndaVzVrYVdObGN6QXpJaXdLSUNBZ0lDQWdJblpoYkc5eUlqb2dJbng4Zkh3aUNpQWdJQ0I5TEFvZ0lDQWdld29nSUNBZ0lDQWlZMkZ0Y0c4aU9pQWlZWEJsYm1ScFkyVnpNRFFpTEFvZ0lDQWdJQ0FpWlhScGNYVmxkR0VpT2lBaVlYQmxibVJwWTJWek1EUWlMQW9nSUNBZ0lDQWlkbUZzYjNJaU9pQWlJQ0lLSUNBZ0lIMHNDaUFnSUNCN0NpQWdJQ0FnSUNKallXMXdieUk2SUNKc2FYTjBZVVZ0WVdsc2N5SXNDaUFnSUNBZ0lDSmxkR2x4ZFdWMFlTSTZJQ0pzYVhOMFlVVnRZV2xzY3lJc0NpQWdJQ0FnSUNKMllXeHZjaUk2SUNKdFlYSnBiM05BWm5KbGRXNWtjMkV1WTI5dElnb2dJQ0FnZlN3S0lDQWdJSHNLSUNBZ0lDQWdJbU5oYlhCdklqb2dJbVJwY21WdWRISmxaMkVpTEFvZ0lDQWdJQ0FpWlhScGNYVmxkR0VpT2lBaVpHbHlaVzUwY21WbllTSXNDaUFnSUNBZ0lDSjJZV3h2Y2lJNklDSWdJZ29nSUNBZ2ZRb2dJRjBLZlEuUzRZZjZLOTVMeUVpQV9UTTZ3S2tfeEVLeDU4TU12VnNjZFg4cDNQVmZvVmFBUlpneWtaeWNTSzl6aWp2SnZUdEZRYlhHdjVkUGo3YzBiZU5BLXFTZEhUU3o2c1Z5THZhMTkwa0lEVWRRV2dIVm1nM0JfZEZ4cXVScmNrS3FmUFdqSVpIX2hHcHRicmZXTmhXQzNvWTdfZGVFQXpHRlQtQVhHODBjSjFpMlNZeFRIRzRyUk5SVGRNcktPSklLZlk3VWFYY3QzcGwxVlBESUpKVVpBNF9Qajd5bDJ0NEdYYTgxMXpFZEZheEtUVmlzdi1kdDAwenpHZ0xCRDhlTmg2ZG93clNFSmlUU1lzbkNQQXJCNzRtVkpIQXk3dkxlUkxpTTljMnd2ZDNLM2hCYUZ2Y2ZTazJ5YU9EekRHaUNsZS1tSFRneWVoMVFfOUVaX21jWDJ2OWFBIgp9.ThC1iX-LGACPU-LcBKR9sBHAcVdeRXAovCnvXGsEwnkjYaErbQBgEoxjEM8tVc7-Irbf8m9VbVtw2QCIW5vS6yJHTpg6DgS1kfG-IVX-sGpqOVb4Io0Su0Ew_AejhFfJsZi1bEbgRR_8N-wIqRX52CECYhOR7NGjiRzQSCZS5LvWkkkKu0EQ2xjpm--b9PQ8byYnNT3P6DrhbEkizLTC7cMh_RS3P5qgtCR5YBGmo4Aeb0mqISfkGNZbgRE8l282pYN434i0BqWDPgaGvPXn4PwKFHOCpjEoM5thEPO2IGAeuHfOAPl7B340eMQrxDVUIaxAKj684sEZ0U3DgNBWhw"
     * }
     * @return mensaje sobre el resultado del procesamiento del documento DTE
     */
    @PostMapping(value = "/procesarJson/{codgeneracion}/{codtd}", 
                 produces = "application/json", 
                 consumes = "application/json")
    public String procesamientoDTE(@PathVariable String codgeneracion, 
                                   @PathVariable String codtd, 
                                   @RequestBody String strGson) {
        String respuesta = service.recepcionDTE(strGson,codgeneracion,codtd);
        return respuesta;
        //return ResponseEntity.ok("Se lee la cola");
    }
    
    @RequestMapping(value = "/activarListener", method = RequestMethod.GET)
    public ResponseEntity<?> firstPage() {
        for(int i=1; i<=4;i++){
           ProcessThread hilo = new ProcessThread(service, i);
           hilo.start();
           listenerProcessContainer.AgregaHilosAdd (hilo);
        }
        return ResponseEntity.ok("Activacion exitosa");
    }
}
